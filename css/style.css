/* 全局設定 */
body { font-family: "Microsoft JhengHei", sans-serif; background: #1a1a1a; color: #eee; margin: 0; padding: 20px; height: 100vh; overflow: hidden; box-sizing: border-box; }

/* 頂部標題與設定 (平時隱藏，滑鼠移過去顯示，以免干擾戰鬥畫面) */
.header-area { 
    position: absolute; top: 0; left: 0; width: 100%; z-index: 100; 
    background: rgba(0,0,0,0.8); transform: translateY(-90%); transition: 0.3s; padding: 10px;
}
.header-area:hover { transform: translateY(0); }
.setup-panel { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; }
.setup-group { display: flex; flex-direction: column; gap: 2px; font-size: 12px; }
select { background: #333; color: #fff; border: 1px solid #555; padding: 2px; }

/* --- 核心佈局：六宮格 Grid System --- */
/* Row 1: [1: Enemy Area (span 2)] [3: Log Area]
   Row 2: [4-5: Party Area (span 2)] [6: Action Area]
*/
.main-stage {
    display: grid;
    grid-template-columns: 2fr 2fr 1.5fr; /* 左右寬，右邊窄一點放 Log/按鈕 */
    grid-template-rows: 1fr 1fr;          /* 上下各一半 */
    height: 90vh;
    gap: 10px;
    padding-top: 40px; /* 避開 Header */
}

/* 區域 1 & 2: 敵人 (左上 + 中上) */
.area-enemy {
    grid-column: 1 / 3;
    grid-row: 1 / 2;
    display: flex;
    align-items: center; /* 垂直置中 */
    justify-content: flex-start; /* 靠左 */
    padding-left: 50px;
}

/* 區域 3: 戰鬥日誌 (右上) */
.area-log {
    grid-column: 3 / 4;
    grid-row: 1 / 2;
    display: flex;
    flex-direction: column;
}

/* 區域 4 & 5 & 6左: 我方隊伍 (左下 + 中下) */
.area-party {
    grid-column: 1 / 3;
    grid-row: 2 / 3;
    display: flex;
    align-items: flex-end; /* 靠底 */
    justify-content: center;
    gap: 20px;
    padding-bottom: 20px;
}

/* 區域 6右: 行動按鈕 (右下) */
.area-action {
    grid-column: 3 / 4;
    grid-row: 2 / 3;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

/* --- 元件樣式 --- */

/* 1. 敵人卡片 (極簡化) */
.enemy-card { 
    width: 450px;
    background: transparent; /* 去掉背景框 */
    border: none;
    box-shadow: none;
    text-align: left;
    position: relative;
}
/* 隱藏頭像與標籤 */
.enemy-avatar, .enemy-info .tags, .enemy-info #e-class, .enemy-info #e-attr { display: none; }

.enemy-info h3 { 
    font-size: 24px; margin: 0 0 5px 0; text-shadow: 2px 2px 4px #000; 
}
.hp-bar-container { background: rgba(0,0,0,0.5); height: 15px; border-radius: 8px; overflow: hidden; border: 1px solid #555; }
.hp-fill { height: 100%; background: linear-gradient(90deg, #66bb6a, #43a047); width: 100%; transition: width 0.3s; }
.enemy-fill { background: linear-gradient(90deg, #ef5350, #c62828); }

/* 2. 我方從者卡片 */
.servant-card {
    width: 140px;
    background: rgba(0,0,0,0.4);
    border-radius: 8px;
    padding: 10px;
    text-align: center;
    position: relative;
    border: 1px solid #444;
}
.avatar-img { width: 100px; height: 100px; border-radius: 50%; border: 3px solid #fff; object-fit: cover; background: #000; box-shadow: 0 4px 8px rgba(0,0,0,0.8); }
.np-bar-container { background: #333; height: 8px; border-radius: 4px; overflow: hidden; margin-top: 5px; }
.np-fill { height: 100%; background: linear-gradient(90deg, #42a5f5, #1e88e5); width: 0%; }

/* 3. 戰鬥日誌 */
.log-box { 
    background: rgba(0,0,0,0.7); 
    color: #81c784; 
    font-family: monospace; 
    height: 100%; 
    overflow-y: auto; 
    padding: 10px; 
    border-left: 2px solid #444; 
    font-size: 13px;
}
.log-entry { margin-bottom: 5px; border-bottom: 1px solid #333; }

/* 4. Action 區域 (Attack 按鈕 & 星星) */
.crit-stars {
    font-size: 24px; color: #ffd700; font-weight: bold; margin-bottom: 20px;
    text-shadow: 0 0 10px #ffb300; display: flex; align-items: center; gap: 10px;
}
.big-attack-btn {
    width: 130px; height: 130px;
    border-radius: 50%;
    background: radial-gradient(circle, #03a9f4, #01579b);
    border: 4px solid #81d4fa;
    color: white;
    font-size: 28px;
    font-weight: bold;
    font-style: italic;
    cursor: pointer;
    box-shadow: 0 0 20px rgba(3, 169, 244, 0.6);
    transition: transform 0.1s, box-shadow 0.2s;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
}
.big-attack-btn:hover { transform: scale(1.05); box-shadow: 0 0 30px rgba(3, 169, 244, 0.9); }
.big-attack-btn:active { transform: scale(0.95); }
.attack-text { font-size: 14px; font-weight: normal; margin-top: -5px; }

/* --- 指令卡選擇覆蓋層 (Overlay) --- */
.command-overlay {
    position: absolute; bottom: 0; left: 0; width: 100%; height: 60%;
    background: linear-gradient(to top, rgba(0,0,0,0.95), rgba(0,0,0,0.8));
    z-index: 50;
    display: none; /* 預設隱藏 */
    flex-direction: column; align-items: center; justify-content: center;
    border-top: 2px solid #555;
    backdrop-filter: blur(5px);
}
.command-overlay.active { display: flex; }

/* 覆用之前的卡片樣式，微調位置 */
.selected-slots { display: flex; gap: 20px; margin-bottom: 30px; }
.card-slot { width: 120px; height: 120px; border: 2px dashed #666; display: flex; align-items: center; justify-content: center; color: #555; position: relative; }
.hand-area { display: flex; gap: 15px; }
.card-container { width: 120px; height: 120px; cursor: pointer; transition: transform 0.2s; position: relative; }
.card-container:hover { transform: translateY(-20px); }
.card-container.used { filter: grayscale(100%) brightness(0.3); transform: none; }
.command-card-img { width: 100%; height: 100%; border-radius: 6px; }
.owner-badge { position: absolute; top: -10px; left: -10px; width: 40px; height: 40px; border-radius: 50%; border: 2px solid #ffd700; background: #000; z-index: 10; }

.btn-back { position: absolute; top: 20px; right: 20px; background: #d32f2f; color: white; border: none; padding: 5px 15px; border-radius: 4px; cursor: pointer; }
